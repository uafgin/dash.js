{"version":3,"sources":["../../../../../src/streaming/rules/DroppedFramesHistory.js"],"names":["DroppedFramesHistory","values","lastDroppedFrames","lastTotalFrames","push","index","playbackQuality","droppedVideoFrames","totalVideoFrames","intervalDroppedFrames","intervalTotalFrames","isNaN","getDroppedFrameHistory","reset","getFrameHistory","__dashjs_factory_name","factory","FactoryMaker","getClassFactory"],"mappings":"sEACA,qD,4IAGA,QAASA,qBAAT,EAAgC,CAE5B,GAAIC,QAAS,EAAb,CACA,GAAIC,mBAAoB,CAAxB,CACA,GAAIC,iBAAkB,CAAtB,CAEA,QAASC,KAAT,CAAcC,KAAd,CAAqBC,eAArB,CAAsC,CAClC,GAAIC,oBAAqBD,iBAAmBA,gBAAgBC,kBAAnC,CAAwDD,gBAAgBC,kBAAxE,CAA6F,CAAtH,CACA,GAAIC,kBAAmBF,iBAAmBA,gBAAgBE,gBAAnC,CAAsDF,gBAAgBE,gBAAtE,CAAyF,CAAhH,CAEA,GAAIC,uBAAwBF,mBAAqBL,iBAAjD,CACAA,kBAAoBK,kBAApB,CAEA,GAAIG,qBAAsBF,iBAAmBL,eAA7C,CACAA,gBAAkBK,gBAAlB,CAEA,GAAI,CAACG,MAAMN,KAAN,CAAL,CAAmB,CACf,GAAI,CAACJ,OAAOI,KAAP,CAAL,CAAoB,CAChBJ,OAAOI,KAAP,EAAgB,CAACE,mBAAoBE,qBAArB,CAA4CD,iBAAkBE,mBAA9D,CAAhB,CACH,CAFD,IAEO,CACHT,OAAOI,KAAP,EAAcE,kBAAd,EAAoCE,qBAApC,CACAR,OAAOI,KAAP,EAAcG,gBAAd,EAAkCE,mBAAlC,CACH,CACJ,CACJ,CAED,QAASE,uBAAT,EAAkC,CAC9B,MAAOX,OAAP,CACH,CAED,QAASY,MAAT,CAAeP,eAAf,CAAgC,CAC5BL,OAAS,EAAT,CACAC,kBAAoBI,gBAAgBC,kBAApC,CACAJ,gBAAkBG,gBAAgBE,gBAAlC,CACH,CAED,MAAO,CACHJ,KAAMA,IADH,CAEHU,gBAAiBF,sBAFd,CAGHC,MAAOA,KAHJ,CAAP,CAKH,CAEDb,qBAAqBe,qBAArB,CAA6C,sBAA7C,CACA,GAAMC,SAAUC,uBAAaC,eAAb,CAA6BlB,oBAA7B,CAAhB,C,gBACegB,O","file":"DroppedFramesHistory.js","sourcesContent":["\r\nimport FactoryMaker from '../../core/FactoryMaker';\r\n\r\n\r\nfunction DroppedFramesHistory() {\r\n\r\n    let values = [];\r\n    let lastDroppedFrames = 0;\r\n    let lastTotalFrames = 0;\r\n\r\n    function push(index, playbackQuality) {\r\n        let droppedVideoFrames = playbackQuality && playbackQuality.droppedVideoFrames ? playbackQuality.droppedVideoFrames : 0;\r\n        let totalVideoFrames = playbackQuality && playbackQuality.totalVideoFrames ? playbackQuality.totalVideoFrames : 0;\r\n\r\n        let intervalDroppedFrames = droppedVideoFrames - lastDroppedFrames;\r\n        lastDroppedFrames = droppedVideoFrames;\r\n\r\n        let intervalTotalFrames = totalVideoFrames - lastTotalFrames;\r\n        lastTotalFrames = totalVideoFrames;\r\n\r\n        if (!isNaN(index)) {\r\n            if (!values[index]) {\r\n                values[index] = {droppedVideoFrames: intervalDroppedFrames, totalVideoFrames: intervalTotalFrames};\r\n            } else {\r\n                values[index].droppedVideoFrames += intervalDroppedFrames;\r\n                values[index].totalVideoFrames += intervalTotalFrames;\r\n            }\r\n        }\r\n    }\r\n\r\n    function getDroppedFrameHistory() {\r\n        return values;\r\n    }\r\n\r\n    function reset(playbackQuality) {\r\n        values = [];\r\n        lastDroppedFrames = playbackQuality.droppedVideoFrames;\r\n        lastTotalFrames = playbackQuality.totalVideoFrames;\r\n    }\r\n\r\n    return {\r\n        push: push,\r\n        getFrameHistory: getDroppedFrameHistory,\r\n        reset: reset\r\n    };\r\n}\r\n\r\nDroppedFramesHistory.__dashjs_factory_name = 'DroppedFramesHistory';\r\nconst factory = FactoryMaker.getClassFactory(DroppedFramesHistory);\r\nexport default factory;\r\n"]}